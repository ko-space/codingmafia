<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>코딩 마피아 게임</title>
  <link rel="stylesheet" href="./style.css"/>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <h1 class="title-center">코딩 마피아 게임</h1>
      <div class="top-bars">
        <div class="bar">
          <span>프로젝트 진행률</span>
          <div class="progress"><div id="projBar"></div></div>
          <span id="projText">0%</span>
        </div>
        <div class="bar">
          <span id="phaseLabel">-</span>
          <div class="progress"><div id="phaseBar"></div></div>
          <span id="phaseTime">--s</span>
        </div>
      </div>
      <div id="you" class="you"></div>
    </header>

    <section class="controls lobby-only">
      <input id="nameInput" placeholder="닉네임 입력" maxlength="20"/>
      <button id="setNameBtn">닉네임 설정</button>

      <details id="avatarFold" class="avatar-fold">
        <summary>아바타 선택 (클릭하여 접기/펼치기)</summary>
        <div class="avatar-controls">
          <input id="avatarInput" placeholder="아바타 이미지 URL"/>
          <button id="setAvatarBtn">아바타 설정</button>
        </div>
        <div id="avatarGrid" class="grid"></div>
      </details>

      <div class="mode-row">
        <button id="spectateBtn">관전 모드</button>
        <button id="joinBtn">참가 모드</button>
      </div>

      <div class="host-only host-panel">
        <label>마피아 <input id="mafiaCount" type="number" min="0" max="10" value="3"></label>
        <label>의사 <input id="doctorCount" type="number" min="0" max="10" value="2"></label>
        <label>경찰 <input id="policeCount" type="number" min="0" max="10" value="2"></label>
        <button id="applyRolesBtn">역할 수 적용</button>
        <button id="revealBtn">추방 시 역할공개 토글</button>
        <button id="startBtn">호스트 시작</button>
      </div>
    </section>

    <main class="game">
      <aside class="left">
        <section class="card players">
          <h2>플레이어</h2>
          <ul id="playerList"></ul>
        </section>

        <section id="nightActions" class="card hidden">
          <h2>밤 행동</h2>
          <div id="nightInfo" class="muted"></div>
          <div id="nightControls"></div>
        </section>

        <section id="quizArea" class="card hidden">
          <h2>꿈속의 넌센스</h2>
          <div id="quizQ" class="quiz-q"></div>
          <input id="quizA" placeholder="정답 입력"/>
          <button id="quizSubmit">정답 제출</button>
          <div id="quizMsg" class="muted"></div>
        </section>
      </aside>

      <section class="center card" id="taskArea">
        <h2 id="taskTitle">코딩 미션</h2>
        <div id="taskBox" class="task-box">
          <div id="taskPrompt"></div>
          <div id="taskChoices" class="choices"></div>
          <div class="task-controls">
            <button id="reqTaskBtn" class="day-only">새 작업 받기</button>
          </div>
        </div>
      </section>

      <aside class="right">
        <section class="card" id="chatArea">
          <h2>대화</h2>
          <div id="chatLog" class="chat-log"></div>
          <div class="chat-send">
            <input id="chatInput" placeholder="메시지 입력 (엔터)"/>
            <button id="chatSend">보내기</button>
          </div>
        </section>

        <section id="meetingArea" class="card hidden">
          <h2>회의 / 투표</h2>
          <select id="voteTarget"></select>
          <button id="voteBtn">투표</button>
          <p class="muted">동률이면 추방 없음.</p>
        </section>
      </aside>
    </main>

    <section class="logs card">
      <h2>로그</h2>
      <ul id="logList"></ul>
    </section>
  </div>

  <div id="blackout" class="blackout hidden">
    <div id="blackoutText" class="blackout-text"></div>
  </div>

  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js" crossorigin="anonymous"></script>
  <script src="./config.js"></script>
  <script src="./client.js"></script>
</body>
</html>
